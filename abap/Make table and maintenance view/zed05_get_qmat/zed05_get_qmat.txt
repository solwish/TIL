FUNCTION zed05_get_qmat.
*"----------------------------------------------------------------------
*"*"Local Interface:
*"  IMPORTING
*"     REFERENCE(I_ART) TYPE  QMAT-ART
*"     REFERENCE(I_MATNR_L) TYPE  QMAT-MATNR OPTIONAL
*"     REFERENCE(I_MATNR_H) TYPE  QMAT-MATNR OPTIONAL
*"     REFERENCE(I_WERKS_L) TYPE  QMAT-WERKS OPTIONAL
*"     REFERENCE(I_WERKS_H) TYPE  QMAT-WERKS OPTIONAL
*"  EXPORTING
*"     REFERENCE(E_CODE) TYPE  CHAR1
*"     REFERENCE(E_MESSAGE) TYPE  CHAR100
*"  TABLES
*"      T_LIST TYPE  ZT05_QMAT_T
*"      IT_MATNR TYPE  STANDARD TABLE
*"      IT_WERKS TYPE  STANDARD TABLE
*"----------------------------------------------------------------------
  CLEAR : t_list, t_list[].

*  RANGES : lr_matnr FOR qmat-matnr,
*           lr_werks FOR qmat-werks.
*
*  CLEAR : lr_matnr, lr_matnr[], lr_werks, lr_werks[].
*
*  IF i_matnr_h IS NOT INITIAL AND
*     i_matnr_l IS NOT INITIAL.
*
*    lr_matnr-sign   = 'I'.
*    lr_matnr-option = 'BT'.
*    lr_matnr-low    = i_matnr_l.
*    lr_matnr-high   = i_matnr_h.
*
*    APPEND lr_matnr.
*    CLEAR lr_matnr.
*
*  ELSEIF i_matnr_h IS NOT INITIAL AND
*         i_matnr_l IS INITIAL.
*
*    lr_matnr-sign   = 'I'.
*    lr_matnr-option = 'BT'.
*    lr_matnr-high   = i_matnr_h.
*
*    APPEND lr_matnr.
*    CLEAR lr_matnr.
*
*  ELSEIF i_matnr_h IS INITIAL AND
*         i_matnr_l IS NOT INITIAL.
*
*    lr_matnr-sign   = 'I'.
*    lr_matnr-option = 'EQ'.
*    lr_matnr-low    = i_matnr_l.
*
*    APPEND lr_matnr.
*    CLEAR lr_matnr.
*
*  ENDIF.
*
*  IF i_werks_h IS NOT INITIAL AND
*     i_werks_l IS NOT INITIAL.
*
*    lr_werks-sign   = 'I'.
*    lr_werks-option = 'BT'.
*    lr_werks-low    = i_werks_l.
*    lr_werks-high   = i_werks_h.
*
*    APPEND lr_werks.
*    CLEAR lr_werks.
*
*  ELSEIF i_werks_h IS NOT INITIAL AND
*         i_werks_l IS INITIAL.
*
*    lr_werks-sign   = 'I'.
*    lr_werks-option = 'BT'.
*    lr_werks-high   = i_werks_h.
*
*    APPEND lr_werks.
*    CLEAR lr_werks.
*
*  ELSEIF i_werks_h IS INITIAL AND
*         i_werks_l IS NOT INITIAL.
*
*    lr_werks-sign   = 'I'.
*    lr_werks-option = 'EQ'.
*    lr_werks-low    = i_werks_l.
*
*    APPEND lr_werks.
*    CLEAR lr_werks.
*
*  ENDIF.

  IF i_art IS INITIAL.
    e_code    = 'E'.
    e_message = 'Input ART'.
    EXIT.
  ENDIF.

*  이거 안해줘도 돼. 바보같은 실수였음. 이미 넘어져 옴. 저쪽에서 그냥 바로 lt_matnr 써주면 돼.
*  lt_matnr = s_matnr.
*  lt_werks = s_werks.

  SELECT a~art a~matnr a~werks b~kurztext c~maktx
         d~name1 AS werks_desc a~sproz a~qkzverf
    INTO CORRESPONDING FIELDS OF TABLE t_list
    FROM qmat AS a
    INNER JOIN tq30t AS b
    ON a~art EQ b~art
    AND b~sprache EQ 'EN'
    INNER JOIN makt AS c
    ON a~matnr EQ c~matnr
    AND c~spras EQ 'EN'
    INNER JOIN t001w AS d
    ON a~werks EQ d~werks
    WHERE a~art EQ i_art
    AND a~matnr IN it_matnr
    AND a~werks IN it_werks.

  IF sy-subrc NE 0.
    e_code    = 'E'.
    e_message = 'No data found'.
  ENDIF.


ENDFUNCTION.


*Messages
*----------------------------------------------------------
*
* Message class: ALE_MSGID
*ALE
*
* Message class: AM
*287   Address cannot be maintained; entry in table TSADRV missing
*290   Entry missing in TSADRV; new address maintenance cannot be called
*291   Entry missing in TSADRV; new address maintenance cannot be called
*298   Address group & not defined; delete flag for address not possible
*I_M
*
* Message class: EC
*089   Internal error: Unable to read screen data
*
* Message class: PM_ID
*PM_
*
* Message class: SCPR
*026   Table & is too wide. It cannot be processed
*028   The table/view & has no generated maintenance dialog
*035   Dictionary interface error: Contact SAP
*120   Table/view & not found
*273   Function module call error
*320   BC Set processing error
*395   Internal field description read error
*399   No data record activation information
*408   Table key not supported by activation links
*
* Message class: SV
*001   The selected function is not supported
*002   Number of retrieved entries: &
*004   No entries found that match selection criteria
*005   One entry chosen
*006   Number of chosen entries: &
*007   No previous entry exists
*008   No next entry exists
*009   An entry already exists with the same key
*010   An entry with this key is marked for deletion
*011   Number of deleted entries: &
*012   Number of changed entries: &
*013   Entry deleted
*014   Number of entries copied: &
*015   Target key must be different from source key
*016   Number of reset entries: &
*017   Entry reset
*018   Data was saved
*019   Choose the key from the allowed namespace
*024   Specify target entries
*025   Specify target entries
*026   Select entries before performing the function
*028   Table & not in DDIC
*032   Position the cursor on a valid entry
*033   Specify the key within the work area
*037   The maintenance dialog for & is incomplete or not defined
*039   Table & has no relevant fields
*040   & entries reset, & original and & new entries are still marked
*041   & entries reset, & original entries are still marked
*042   & entries reset, & new entries are still marked
*043   Data already saved
*044   Read access only
*045   Enter a start date that is before the end date
*046   Enter an end date that is after the start date
*047   Overlapping records are deleted or delimited
*049   Data locked by user & (display only)
*050   System error: Unable to lock table/view &
*051   No data maintenance authorization; display only
*053   No display authorization for requested data
*054   Maintenance of data in current client & not permitted
*055   Address for object & not found
*056   Mark at least one entry before selecting this function
*057   The selected entry is new and has no original
*058   The selected entries are new and have no original
*059   The selected entry is still in its original state
*060   The selected entries are still in their original state
*061   & entries are still originals, & new entries have no original
*065   No entries exist, double-click for long text
*066   Select block end
*084   No values can be displayed
*092   Change task & is being processed
*095   System error changing change task &
*096   Task & was changed
*098   Entry flagged for inclusion in task &
*099   Entry was flagged for deletion from task &
*105   & entries were flagged for inclusion in task &
*106   & entries were flagged for deletion from task &
*107   Entry was already in task &
*108   & entries were already in task &
*109   & entries included, & entries were contained: &
*110   Entry was not in task &
*111   & entries deleted, & entries were not included: &
*112   & entries were not in task &
*113   Entry could not be retrieved
*114   & entries could not be retrieved
*115   Entry could not be deleted
*116   & entries could not be deleted
*117   Do not make any changes (SAP entry)
*120   Other entries are retrieved and modified if necessary
*121   Deleted entry will be recovered and possibly changed
*122   Entry was delimited
*123   Number of delimited entries: &
*124   Process delimited entries
*125   Process delimited entry
*127   Delimit area of validity
*128   Delivery class &, transport not possible
*129   Related objects in various tasks
*130   Client & is local, transport not permitted
*132   Object locked for task &1, user &2 only display permitted
*134   Inconsistency in object definition, only display permitted
*136   Change with caution, entry belongs to customer
*138   Check maintenance object &1 or update function group &2
*139   Address data not applied
*140   &1 entries deleted; &2 entries added
*141   Individual entries not added to the change request
*142   Transport is not possible for the specified data
*153   No language was chosen
*160   The installed system code page does not allow any other languages
*161   Put the cursor on a form name
*162   The object &1 &2 &3 cannot be put in a request
*164   Table/view &1 is not in the Dictionary
*173   Function group &1 inconsistent
*174   Enter values in work area for non-key fields
*175   The selected BC Set function is not supported
*177   Data record contains fix value from BC Set and cannot be deleted
*183   Error in remote access to central Customizing Distribution system
*184   Data record contains fixed value from BC Set and cannot be changed
*202   You are not authorized to change fields with fixed BC Set values
*306   Table/view & is not active
*413   & selected entries cannot be deleted
*538   Dropdown lists are not supported in view clusters
*757   You have no maintenance authorization for this table key
*763   You have no maintenance authorization for the displayed data records
*764   Changed data record selection
*766   Restricted display of datasets
*808   Not all columns in the table can be displayed in the list
*810   View &1 is more than 1000 characters long
*818   &1 of &2 Business Configuration Set entries imported
*819   Business Configuration Set imported
*830   Last selected entry has been reached
*831   First selected entry has been reached
*MSG
*P_M
*
* Message class: TB
*109   No maintenance authorization for cross-client tables (see Help)
*
* Message class: TK
*430   Client &1 has status 'not modifiable'
*729   Changes to repository objects are not permitted in this client
*730   Changes to repository or cross-client customizing are not permitted
*731   Cross-client customizing cannot be modified
*
* Message class: VIM_AUTH_MSGID
*VIM

----------------------------------------------------------------------------------
Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 750
